<!DOCTYPE html>

<html>

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>RSVP for FutSoul</title>
    <link rel="stylesheet" href="rsvp.css" />
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
  </head>

  <body>
    <div class="card">
      <h1>futsoul pickup</h1>
      <p class="subheader">$5 session fee helps cover equipment costs such as goals and pinnies. please venmo @larissa-ala before submitting rsvp.</p>


      <form id="rsvpForm">

        <label>name</label>
        <input type="text" id="name" required>

        <label>email</label>
        <input type="email" id="email">

        <label>skill level</label>
        <select id="skill">
          <option>casual</option>
          <option>competitive</option>
        </select>

        <label>availability</label>
        <label class="white-text"><input type="checkbox" id="attending"> i will attend</label>

        <label>notifications</label>
        <label class="white-text"><input type="checkbox" id="notify"> update me on future sessions</label>

        <button type="submit">submit rsvp</button>

        <!-- SUCCESS MESSAGE ADDED HERE -->
        <p id="successMsg" class="successMsg" style="display:none;"></p>

      </form>

      <div class="card-bottom">
        <a href="index.html">← back to homepage</a>
      </div>

    </div>

    <script>
      const SUPABASE_URL = "https://xofjwxgwqtldiimaxitz.supabase.co";
      const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhvZmp3eGd3cXRsZGlpbWF4aXR6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQyMDY0MTMsImV4cCI6MjA3OTc4MjQxM30.oc8w_59VMFc6LGmhHdclMng4wSsIDWHqtm4VFkJC_eQ";

      const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

      document.getElementById('rsvpForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const { error } = await supabaseClient
          .from('rsvps')
          .insert([
            {
              name: document.getElementById('name').value,
              email: document.getElementById('email').value,
              skill: document.getElementById('skill').value,
              attending: document.getElementById('attending').checked,
              notify: document.getElementById('notify').checked
            }
          ]);

        const msg = document.getElementById('successMsg');

        if (error) {
          msg.innerText = "❌ There was an issue submitting your RSVP. Please try again.";
          msg.style.display = "block";
        } else {
          msg.innerText =
            "Thank you for RSVPing! A $5 session fee is required to confirm your spot. You will receive a follow-up email once confirmed.";
          msg.style.display = "block";
          document.getElementById('rsvpForm').reset();
        }
      });
    </script>



  </body>

</html>
